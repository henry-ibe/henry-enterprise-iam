################################################################################
# OAuth2-Proxy Configuration
# Henry Enterprise LLC â€” Employee Portal (Phase 60)
################################################################################

provider = "oidc"
provider_display_name = "Henry Enterprise SSO"
oidc_issuer_url = "http://keycloak:8080/realms/henry-enterprise"
redirect_url = "https://portal.henry-enterprise.local/oauth2/callback"
code_challenge_method = "S256"

client_id = "employee-portal"
client_secret = "KbWKYEPZ7P3k0k6AHPiDPyjn1pN0jLSm"

scope = "openid profile email roles"
email_domains = ["*"]
insecure_oidc_allow_unverified_email = true

cookie_name = "_henry_oauth2"
cookie_secret = "62Ps5fKzPa6jGuLIBKRX6UKj4ajjcbSd"
cookie_domains = [".henry-enterprise.local"]
cookie_secure = true
cookie_httponly = true
cookie_samesite = "lax"
cookie_expire = "24h"
cookie_refresh = "1h"

session_store_type = "redis"
redis_connection_url = "redis://redis:6379"

set_xauthrequest = true
pass_authorization_header = true
pass_access_token = true
pass_user_headers = true
set_authorization_header = true

upstreams = ["http://portal-router:8500"]
skip_provider_button = false

skip_auth_routes = [
  "^/health$",
  "^/ready$"
]

request_logging = true
auth_logging = true
standard_logging = true

http_address = "0.0.0.0:4180"
reverse_proxy = true
ssl_insecure_skip_verify = true

